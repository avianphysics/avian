# Migrating From v0.4 to `main`

This file contains migration guides for breaking changes that have happened on the `main` branch
since the latest release. These guides are evolving and may not be polished yet.

See [migration-guides/README.md](./README.md) and existing entries for information about Avian's
migration guide process and what to put here.


## Normals are now `Dir`s

`bevy_math` makes a conscious difference between `Dir2`/`Dir3` and `Vec2`/`Vec3`. `Vec2`/`Vec3` can be any kind of vector,
while `Dir2`/`Dir3` are guaranteed to be normalized. This is a very useful way to encode numerical assumptions directly into the type system.

For simplicity, Avian used to use `Vec2`/`Vec3` for all kinds of vectors, which could be frustrating to users correctly encoding their normals as `Dir2`/`Dir3`. In 0.5, Avian uses `Dir2`/`Dir3` under the common `math::Dir` type alias for all normals in its API.

If you require a `Vec2`/`Vec3`, you can use the `From` implementation to convert a `Dir` to a `Vector`:

```rust
let vector: Vector = normal.into();
```

If you need to convert a `Vector` to a `Dir`, you can use `Dir::new`

```rust
let dir = Dir3::new(vector).unwrap();
```

or, if you already know your vector is normalized, you can use `Dir::new_unchecked`

```rust
let dir = Dir3::new_unchecked(vector);
```
